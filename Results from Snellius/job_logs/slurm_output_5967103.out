============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius#SoftwarepolicySnellius-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
Args in experiment:
Namespace(is_training=1, random_future=True, decoder_lens_test=True, model_id='seed42_ECL_96_96', model='Autoformer', from_checkpoint='', seed=42, version='Fourier', mode_select='random', modes=64, L=3, base='legendre', cross_activation='tanh', individual=False, data='custom', root_path='./dataset/electricity/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', HourOfDay_offset=0, DayOfWeek_offset=0, DayOfMonth_offset=0, DayOfYear_offset=0, empty_data=False, empty_time=False, seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=321, dec_in=321, c_out=321, d_model=512, n_heads=8, e_layers=8, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3')
Use GPU: cuda:0
>>>>>>>start training : seed42_ECL_96_96_Autoformer_custom_random_future_ftM_sl96_ll48_pl96_dm512_nh8_el8_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.4780141
	speed: 0.1263s/iter; left time: 1425.0896s
	iters: 200, epoch: 1 | loss: 0.4441251
	speed: 0.1081s/iter; left time: 1208.1740s
	iters: 300, epoch: 1 | loss: 0.4212580
	speed: 0.1066s/iter; left time: 1181.6419s
	iters: 400, epoch: 1 | loss: 0.4090188
	speed: 0.1073s/iter; left time: 1178.2414s
	iters: 500, epoch: 1 | loss: 0.4069616
	speed: 0.1089s/iter; left time: 1184.5144s
Epoch: 1 cost time: 63.088905572891235
Epoch: 1, Steps: 569 | Train Loss: 0.4430967 Vali Loss: 0.4402187 Test Loss: 0.4763673
Validation loss decreased (inf --> 0.440219).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3925849
	speed: 0.3735s/iter; left time: 4000.8290s
	iters: 200, epoch: 2 | loss: 0.3943323
	speed: 0.1103s/iter; left time: 1170.0988s
	iters: 300, epoch: 2 | loss: 0.3942133
	speed: 0.1081s/iter; left time: 1136.6590s
	iters: 400, epoch: 2 | loss: 0.3811100
	speed: 0.1081s/iter; left time: 1125.1588s
	iters: 500, epoch: 2 | loss: 0.3861211
	speed: 0.1097s/iter; left time: 1130.9502s
Epoch: 2 cost time: 62.63356685638428
Epoch: 2, Steps: 569 | Train Loss: 0.3895258 Vali Loss: 0.4294744 Test Loss: 0.4801192
Validation loss decreased (0.440219 --> 0.429474).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3785528
	speed: 0.3816s/iter; left time: 3870.3337s
	iters: 200, epoch: 3 | loss: 0.3712946
	speed: 0.1093s/iter; left time: 1097.7286s
	iters: 300, epoch: 3 | loss: 0.3722354
	speed: 0.1091s/iter; left time: 1084.9680s
	iters: 400, epoch: 3 | loss: 0.3697462
	speed: 0.1088s/iter; left time: 1071.0899s
	iters: 500, epoch: 3 | loss: 0.3774099
	speed: 0.1088s/iter; left time: 1059.9898s
Epoch: 3 cost time: 62.71293926239014
Epoch: 3, Steps: 569 | Train Loss: 0.3740873 Vali Loss: 0.4244157 Test Loss: 0.4698714
Validation loss decreased (0.429474 --> 0.424416).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3671812
	speed: 0.3782s/iter; left time: 3620.4216s
	iters: 200, epoch: 4 | loss: 0.3685603
	speed: 0.1090s/iter; left time: 1032.5597s
	iters: 300, epoch: 4 | loss: 0.3669200
	speed: 0.1084s/iter; left time: 1015.7789s
	iters: 400, epoch: 4 | loss: 0.3669645
	speed: 0.1070s/iter; left time: 992.3688s
	iters: 500, epoch: 4 | loss: 0.3689958
	speed: 0.1065s/iter; left time: 976.9949s
Epoch: 4 cost time: 62.184367656707764
Epoch: 4, Steps: 569 | Train Loss: 0.3675851 Vali Loss: 0.4227849 Test Loss: 0.4708462
Validation loss decreased (0.424416 --> 0.422785).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3705628
	speed: 0.3775s/iter; left time: 3399.6047s
	iters: 200, epoch: 5 | loss: 0.3655164
	speed: 0.1074s/iter; left time: 956.8027s
	iters: 300, epoch: 5 | loss: 0.3602800
	speed: 0.1081s/iter; left time: 952.0260s
	iters: 400, epoch: 5 | loss: 0.3657273
	speed: 0.1079s/iter; left time: 939.4835s
	iters: 500, epoch: 5 | loss: 0.3671828
	speed: 0.1074s/iter; left time: 924.0569s
Epoch: 5 cost time: 61.8759708404541
Epoch: 5, Steps: 569 | Train Loss: 0.3640830 Vali Loss: 0.4217630 Test Loss: 0.4725770
Validation loss decreased (0.422785 --> 0.421763).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.3610914
	speed: 0.3760s/iter; left time: 3172.0727s
	iters: 200, epoch: 6 | loss: 0.3610981
	speed: 0.1078s/iter; left time: 898.6926s
	iters: 300, epoch: 6 | loss: 0.3610091
	speed: 0.1094s/iter; left time: 901.0431s
	iters: 400, epoch: 6 | loss: 0.3599812
	speed: 0.1077s/iter; left time: 876.4857s
	iters: 500, epoch: 6 | loss: 0.3589129
	speed: 0.1083s/iter; left time: 870.2532s
Epoch: 6 cost time: 62.13399600982666
Epoch: 6, Steps: 569 | Train Loss: 0.3622998 Vali Loss: 0.4213930 Test Loss: 0.4720461
Validation loss decreased (0.421763 --> 0.421393).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.3607993
	speed: 0.3733s/iter; left time: 2936.6131s
	iters: 200, epoch: 7 | loss: 0.3601235
	speed: 0.1076s/iter; left time: 835.7547s
	iters: 300, epoch: 7 | loss: 0.3624641
	speed: 0.1094s/iter; left time: 839.1285s
	iters: 400, epoch: 7 | loss: 0.3605159
	speed: 0.1102s/iter; left time: 834.2445s
	iters: 500, epoch: 7 | loss: 0.3602518
	speed: 0.1103s/iter; left time: 823.8365s
Epoch: 7 cost time: 62.71141529083252
Epoch: 7, Steps: 569 | Train Loss: 0.3614360 Vali Loss: 0.4200512 Test Loss: 0.4698260
Validation loss decreased (0.421393 --> 0.420051).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3582682
	speed: 0.3806s/iter; left time: 2777.6487s
	iters: 200, epoch: 8 | loss: 0.3609468
	speed: 0.1100s/iter; left time: 791.9083s
	iters: 300, epoch: 8 | loss: 0.3609287
	speed: 0.1096s/iter; left time: 777.9872s
	iters: 400, epoch: 8 | loss: 0.3615075
	speed: 0.1095s/iter; left time: 766.3936s
	iters: 500, epoch: 8 | loss: 0.3584873
	speed: 0.1098s/iter; left time: 757.5764s
Epoch: 8 cost time: 62.98663640022278
Epoch: 8, Steps: 569 | Train Loss: 0.3609566 Vali Loss: 0.4200438 Test Loss: 0.4705870
Validation loss decreased (0.420051 --> 0.420044).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.3625055
	speed: 0.3806s/iter; left time: 2560.9374s
	iters: 200, epoch: 9 | loss: 0.3632150
	speed: 0.1082s/iter; left time: 717.2484s
	iters: 300, epoch: 9 | loss: 0.3600723
	speed: 0.1122s/iter; left time: 732.3001s
	iters: 400, epoch: 9 | loss: 0.3584863
	speed: 0.1097s/iter; left time: 705.5198s
	iters: 500, epoch: 9 | loss: 0.3599384
	speed: 0.1102s/iter; left time: 697.2425s
Epoch: 9 cost time: 63.10051083564758
Epoch: 9, Steps: 569 | Train Loss: 0.3606841 Vali Loss: 0.4198087 Test Loss: 0.4703164
Validation loss decreased (0.420044 --> 0.419809).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.3598912
	speed: 0.3783s/iter; left time: 2330.5586s
	iters: 200, epoch: 10 | loss: 0.3620744
	speed: 0.1109s/iter; left time: 671.8292s
	iters: 300, epoch: 10 | loss: 0.3599125
	speed: 0.1104s/iter; left time: 657.7702s
	iters: 400, epoch: 10 | loss: 0.3613631
	speed: 0.1089s/iter; left time: 637.9612s
	iters: 500, epoch: 10 | loss: 0.3608350
	speed: 0.1091s/iter; left time: 628.2316s
Epoch: 10 cost time: 62.940619468688965
Epoch: 10, Steps: 569 | Train Loss: 0.3605749 Vali Loss: 0.4200755 Test Loss: 0.4706975
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
	iters: 100, epoch: 11 | loss: 0.3643642
	speed: 0.3785s/iter; left time: 2116.4674s
	iters: 200, epoch: 11 | loss: 0.3586573
	speed: 0.1086s/iter; left time: 596.4707s
	iters: 300, epoch: 11 | loss: 0.3612165
	speed: 0.1099s/iter; left time: 592.7374s
	iters: 400, epoch: 11 | loss: 0.3600561
	speed: 0.1103s/iter; left time: 583.5734s
	iters: 500, epoch: 11 | loss: 0.3647588
	speed: 0.1082s/iter; left time: 561.9024s
Epoch: 11 cost time: 62.79604411125183
Epoch: 11, Steps: 569 | Train Loss: 0.3604749 Vali Loss: 0.4195875 Test Loss: 0.4705400
Validation loss decreased (0.419809 --> 0.419588).  Saving model ...
Updating learning rate to 9.765625e-08
	iters: 100, epoch: 12 | loss: 0.3590418
	speed: 0.3804s/iter; left time: 1910.1959s
	iters: 200, epoch: 12 | loss: 0.3628113
	speed: 0.1087s/iter; left time: 534.9778s
	iters: 300, epoch: 12 | loss: 0.3590098
	speed: 0.1077s/iter; left time: 519.3512s
	iters: 400, epoch: 12 | loss: 0.3572448
	speed: 0.1084s/iter; left time: 511.9176s
	iters: 500, epoch: 12 | loss: 0.3602251
	speed: 0.1089s/iter; left time: 503.4036s
Epoch: 12 cost time: 62.35932517051697
Epoch: 12, Steps: 569 | Train Loss: 0.3604539 Vali Loss: 0.4197266 Test Loss: 0.4703330
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-08
	iters: 100, epoch: 13 | loss: 0.3599510
	speed: 0.3767s/iter; left time: 1677.5746s
	iters: 200, epoch: 13 | loss: 0.3602356
	speed: 0.1095s/iter; left time: 476.5923s
	iters: 300, epoch: 13 | loss: 0.3584799
	speed: 0.1085s/iter; left time: 461.5930s
	iters: 400, epoch: 13 | loss: 0.3605147
	speed: 0.1086s/iter; left time: 451.1259s
	iters: 500, epoch: 13 | loss: 0.3606684
	speed: 0.1096s/iter; left time: 444.0666s
Epoch: 13 cost time: 62.64462637901306
Epoch: 13, Steps: 569 | Train Loss: 0.3604214 Vali Loss: 0.4196628 Test Loss: 0.4701585
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-08
	iters: 100, epoch: 14 | loss: 0.3652647
	speed: 0.3769s/iter; left time: 1463.7111s
	iters: 200, epoch: 14 | loss: 0.3591562
	speed: 0.1097s/iter; left time: 415.0635s
	iters: 300, epoch: 14 | loss: 0.3582253
	speed: 0.1085s/iter; left time: 399.5832s
	iters: 400, epoch: 14 | loss: 0.3610665
	speed: 0.1098s/iter; left time: 393.3521s
	iters: 500, epoch: 14 | loss: 0.3630352
	speed: 0.1096s/iter; left time: 381.7444s
Epoch: 14 cost time: 62.776267766952515
Epoch: 14, Steps: 569 | Train Loss: 0.3604409 Vali Loss: 0.4197333 Test Loss: 0.4700798
EarlyStopping counter: 3 out of 3
Early stopping
Saved epoch_oveview here: ./results/seed42_ECL_96_96_Autoformer_custom_random_future_ftM_sl96_ll48_pl96_dm512_nh8_el8_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0/epoch_overview.npy
>>>>>>>testing : seed42_ECL_96_96_Autoformer_custom_random_future_ftM_sl96_ll48_pl96_dm512_nh8_el8_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
test shape: (5165, 96, 321) (5165, 96, 321)
test shape: (5165, 96, 321) (5165, 96, 321)
layer 0 - mse:0.5755094885826111, mae:0.6118263006210327, mase:0.9177987575531006
layer 1 - mse:0.5506290197372437, mae:0.6007945537567139, mase:0.9012500643730164
layer 2 - mse:0.5326016545295715, mae:0.592369019985199, mase:0.8886109590530396
layer 3 - mse:0.5257010459899902, mae:0.5896766185760498, mase:0.8845720887184143
layer 4 - mse:0.4960509240627289, mae:0.5752038359642029, mase:0.8628615140914917
layer 5 - mse:0.48263558745384216, mae:0.5688444375991821, mase:0.8533217906951904
layer 6 - mse:0.4824676215648651, mae:0.5679315328598022, mase:0.8519523739814758
layer 7 - mse:0.4701310396194458, mae:0.5618466138839722, mase:0.842824399471283

JOB STATISTICS
==============
Job ID: 5967103
Cluster: snellius
User/Group: scur2113/scur2113
State: RUNNING
Nodes: 1
Cores per node: 18
CPU Utilized: 02:27:56
CPU Efficiency: 40.25% of 06:07:30 core-walltime
Job Wall-clock time: 00:20:25
Memory Utilized: 13.21 GB
Memory Efficiency: 11.01% of 120.00 GB
WARNING: Efficiency statistics may be misleading for RUNNING jobs.
